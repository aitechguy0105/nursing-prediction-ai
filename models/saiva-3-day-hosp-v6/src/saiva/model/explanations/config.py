from pytz import timezone

exp_dictionary = {

    'default': {
        'meds_days_since_last_event': [],
        'assessments': ["activity assessment", "apex podiatric assessment", "care plan meeting social work note",
                        "coms - dehydration risk evaluation - v 2", "coms - phq9 - v 2", "coms - smoking safety evaluation - v 2",
                        "mds 3.0", "nutrition assessment", "pain assessment (3.0)", "quarterly assessment package", "weekly skin assessment"],
        'diet_order': ["nepro", "nepro (oral)", "npo", "not applicable-npo only", "puree", "pureed",
                       "puree with ground meats",
                       "prostat sf awc", "pro-stat 101", "pro-stat 64", "pro-stat awc", "pro-stat sugar free",
                       "pro-stat profile",
                       "prostat sugar free", "prostat liquid", "prostat, 64", "prostat awc",
                       "calorically dense oral supplement",
                       "mechanical soft", "moist mechanical soft", "mechanical soft with ground meats"],
        'alert_count': [],
        'alerts': ["more than 2 episodes of loose bm's", "resident has not had a bm within 48 hours", "resident refused bathing", 
                   "resident ate less than 25 percent of meal", "no bowel movement", "agitated or nervous more than usual", 
                   "tired weak confused or drowsy", "change in therapy level - decrease", "[a]ggitated or nervous more than usual",
                   "[c]hange in skin color or condition", "[h]elp with walking, transferring, toileting more than usual", 
                   "[o]verall needs more help", "[p]pain - new or worsening; participated less in activities", 
                   "[s]eems different than usual", "[t]alks or communicates less", "[t]ired, weak, confused, or drowsy", 
                   "0% alternate meal consumed", "abnormal vital signs (low/high bp, heart rate, respiratory rate, weight change)", 
                   "abusive language", "agitated or nervous more than usual", "altered mental status", 
                   "ate 25% or less for 3 meals in a row.", "ate 50% or less for 2 or more meals in the day.", "ate less", 
                   "ate less than 25% of snack 3x in 3 days.", "ate less than usual (not because of dislike of food)", 
                   "behavior - frequent crying", "behavior occurred - interventions ineffective.", "behavior- threatening behavior", 
                   "behavior-abusive language", "behavior-biting", "behavior-grabbing", "behavior-kicking/hitting", 
                   "behavior-pinch/scratch/spitting", "behavior-pushing", "behavior-rejection of care", "behavior-repeats movement",
                   "behavior-sexually inappropriate", "behavior-wandering", "behavior-yelling/screaming", 
                   "behavioral symptoms (e.g. agitation, psychosis)", "biting", "c/o pain", "change in skin color or condition", 
                   "complaints or signs of mouth pain", "delusions (describe in nurse's note)", "diarrhea", "did not void", "drank less",
                   "drank less than usual", "fall mats needed", "falls", "fever", 
                   "food and/or fluid intake (decreased or unable to eat and/or drink adequate amounts)", "frequent crying", 
                   "from the poc task for bathing: response was resident refused shower", 
                   "functional decline (worsening function and/or mobility)", "goal and intent to leave (exit seeking)", 
                   "grabbing", "hallucinations (describe in nurse's notes)", 
                   "help with walking, transferring, toileting more than usual", "in bed checking hourly", "kicking / hitting", 
                   "le - resident has not participated in any daily routine activities in past 7 days - please f/u.", 
                   "loose or watery stool reported 2x/24h", "looseÂ stools", "loss of liquids", "more than 2 episodes of loose bm's",
                   "nausea/vomiting", "new behavior occurred.", "new skin condition documented", "new skin condition/refusal/availability",
                   "new skin issue", "new skin issues was documented as yes on the cna skin check task.", "no bm for 3 days", 
                   "no bm in 3 days", "no bm in 3 days ***", "no bm x 3 days", "no bowel movement for 3 days", 
                   "no bowel movement in 3 days; or diarrhea", "no documented bm for 3 days", "no documented voiding in 24hr", 
                   "no documented voiding in 8hr", "no recorded voiding in 24hr", "no recorded voiding in 8 hours", 
                   "no urine output during shift", "ns - a new skin problem was observed.", "ns - at risk for harm or suicide. monitor.",
                   "ns - exit seeking behavior", "ns - expresses desire to leave.", "ns - no/small bowel movement documented for 64 hours", 
                   "ns - resident indicates they have pain.", "ns-resident's adl status has declined.", 
                   "ns-resident's bladder status has declined.", "other change in condition", "overall needs more help", "overall needs more help than usual", "pain - new or worsening; participated less in activities", "pain (uncontrolled)", "pain with swallowing", 
                   "painad indicator of pain", "pinching / scratching / spitting", "resident ate less than 25 percent of meal", 
                   "resident ate less than 25%", "resident did not drink all/most fluids 2x/24 hours.", "resident did not void during 11-7 shift.", 
                   "resident exhibited symptoms of a swallowing disorder.", "resident had less than 360ml with meals 14x/7days.", 
                   "resident has a new skin tear.", "resident has eaten less than 25% for 2 or more meals", "resident has had a fall", 
                   "resident has had no bm documented for 72 hours.", "resident has new reddened area", 
                   "resident has not had a bm documented in the past 72 hours.", "resident has not had a bm in 72 hours", 
                   "resident has not had a bm in 72 or more hours.", "resident has not had a bowel movement in 72 hours.", 
                   "resident is at high risk for falls.", "resident's cognitive status has declined.", "resident/patient is exit seeking",
                   "sexually inappropriate", "shortness of breath", "skin wound or ulcer", "ss- at risk for harm or suicide. monitor.", 
                   "stop alert: agitated or nervous more than usual", "stop alert: ate less", "stop alert: change in skin color or condition", 
                   "stop alert: drank less", "stop alert: help with walking, transferring, toileting more than usual", "stop alert: overall needs more help", "stop alert: pain: new or worsening; participated less in activities",
                   "stop alert: seems different than usual", "stop alert: talks or communicates less", 
                   "stop alert: tired, weak, confused, or drowsy", "stop alert: weight change", "threatening behavior", "tired, weak, confused, or drowsy", "urinary incontinence (new or worsening)", "wandering",
                   "wandering / exit seeking / intrusive behavior", "weight change; swollen legs/feet", 
                   "while eating the resident exhibited coughing, loss of liquids or loss of food from mouth.", "yelling / screaming"],
        
        'diagnosis': [
            'abdominal hernia', 'acute hemorrhagic cerebrovascular disease', 'acute myocardial infarction', 
            'acute phlebitis; thrombophlebitis and thromboembolism', 'acute posthemorrhagic anemia', 'acute pulmonary embolism', 'acute rheumatic heart disease', 'alcohol-related disorders', 'anal and rectal conditions', 'anxiety and fear-related disorders', 
            'aortic and peripheral arterial embolism or thrombosis', 'aortic; peripheral; and visceral artery aneurysms', 'aplastic anemia', 'appendicitis and other appendiceal conditions', 
            'arterial dissections', 'aspiration pneumonitis', 'asthma', 'bacterial infections', 'benign neoplasms', 'biliary tract disease', 
             'bipolar and related disorders', 'bone cancer', 'breast cancer - all other types', 'breast cancer - ductal carcinoma in situ (dcis)', 
             'cns abscess', 'cancer of other sites', 'cannabis-related disorders', 'cardiac arrest and ventricular fibrillation', 'cardiac cancers', 
             'cardiac dysrhythmias', 'cerebral infarction', 'cerebral palsy', 'chronic kidney disease', 
             'chronic obstructive pulmonary disease and bronchiectasis', 'chronic phlebitis; thrombophlebitis and thromboembolism', 
             'chronic rheumatic heart disease', 'coagulation and hemorrhagic disorders', 'complications of acute myocardial infarction', 
             'conditions due to neoplasm or the treatment of neoplasm', 'conduction disorders', 'cornea and external disease', 
             'coronary atherosclerosis and other heart disease', 'cystic fibrosis', 'depressive disorders', 'diabetes mellitus with complication', 
             'diabetes mellitus without complication', 'diseases of middle ear and mastoid (except otitis media)', 'diseases of mouth; excluding dental',
             'diseases of white blood cells', 'disorders of teeth and gingiva', 'diverticulosis and diverticulitis', 'drug induced or toxic related condition',
             'encephalitis', 'endocarditis and endocardial disease', 'endocrine system cancers - adrenocortical', 'endocrine system cancers - all other types', 
             'endocrine system cancers - pancreas', 'endocrine system cancers - parathyroid', 'endocrine system cancers - pituitary gland', 
             'endocrine system cancers - thymus', 'endocrine system cancers - thyroid', 'epilepsy; convulsions', 'esophageal disorders', 
             'essential hypertension', 'female reproductive system cancers - all other types', 'female reproductive system cancers - cervix', 
             'female reproductive system cancers - endometrium', 'female reproductive system cancers - fallopian tube', 
             'female reproductive system cancers - ovary', 'female reproductive system cancers - uterus', 'female reproductive system cancers - vagina', 
             'female reproductive system cancers - vulva', 'fluid and electrolyte disorders', 'foodborne intoxications', 'fungal infections', 'gangrene', 
             'gastritis and duodenitis', 'gastroduodenal ulcer', 'gastrointestinal and biliary perforation', 'gastrointestinal cancers - all other types',
             'gastrointestinal cancers - anus', 'gastrointestinal cancers - bile duct', 'gastrointestinal cancers - colorectal', 
             'gastrointestinal cancers - esophagus', 'gastrointestinal cancers - gallbladder', 'gastrointestinal cancers - liver', 
             'gastrointestinal cancers - peritoneum', 'gastrointestinal cancers - small intestine', 'gastrointestinal cancers - stomach', 
             'gastrointestinal hemorrhage', 'hiv infection', 'hallucinogen-related disorders', 'head and neck cancers - all other types', 
             'head and neck cancers - eye', 'head and neck cancers - hypopharyngeal', 'head and neck cancers - laryngeal', 
             'head and neck cancers - lip and oral cavity', 'head and neck cancers - nasopharyngeal', 'head and neck cancers - pharyngeal', 
             'head and neck cancers - salivary gland', 'head and neck cancers - throat', 'head and neck cancers - tonsils', 'headache; including migraine', 
             'heart failure', 'hemolytic anemia', 'hepatic failure', 'hepatitis', 'hodgkin lymphoma', 
             'hypertension with complications and secondary hypertension', 'immune-mediated/reactive arthropathies', 'immunity disorders', 'infective arthritis',
             'inflammatory conditions of male genital organs', 'influenza', 'inhalant-related disorders', 'intestinal infection', 
             'intestinal obstruction and ileus', 'leukemia - acute lymphoblastic leukemia (all)', 'leukemia - acute myeloid leukemia (aml)', 
             'leukemia - all other types', 'leukemia - chronic lymphocytic leukemia (cll)', 'leukemia - chronic myeloid leukemia (cml)', 'leukemia - hairy cell',
             'lung disease due to external agents', 'male reproductive system cancers - all other types', 'male reproductive system cancers - penis', 
             'male reproductive system cancers - prostate', 'male reproductive system cancers - testis', 'malignant neoplasm, unspecified', 
             'malignant neuroendocrine tumors', 'mediastinal disorders', 'meningitis', 'mesothelioma', 'multiple myeloma', 'muscle disorders', 
             'myelodysplastic syndrome (mds)', 'myocarditis and cardiomyopathy', 'neoplasms of unspecified nature or uncertain behavior', 
             'nephritis; nephrosis; renal sclerosis', 'nervous system cancers - all other types', 'nervous system cancers - brain', 'neurocognitive disorders',
             'non-hodgkin lymphoma', 'noninfectious gastroenteritis', 'noninfectious hepatitis', 'nonrheumatic and unspecified valve disorders', 
             'occlusion or stenosis of precerebral or cerebral arteries without infarction', 'opioid-related disorders', 'osteomyelitis', 
             'other and ill-defined cerebrovascular disease', 'other and ill-defined heart disease', 
             'other nervous system disorders (neither hereditary nor degenerative)', 'other nervous system disorders (often hereditary or degenerative)', 
             'other specified cns infection and poliomyelitis', 'other specified and unspecified circulatory disease', 
             'other specified and unspecified disorders of stomach and duodenum', 'other specified and unspecified endocrine disorders', 
             'other specified and unspecified gastrointestinal disorders', 'other specified and unspecified hematologic conditions', 
             'other specified and unspecified liver disease', 'other specified and unspecified lower respiratory disease', 
             'other specified and unspecified mood disorders', 'other specified and unspecified skin disorders', 
             'other specified bone disease and musculoskeletal deformities', 'other specified diseases of veins and lymphatics', 
             'other specified eye disorders', 'other specified inflammatory condition of skin', 'other specified substance-related disorders', 
             'other specified upper respiratory infections', 'otitis media', 'pancreatic disorders (excluding diabetes)', 
             'paralysis (other than cerebral palsy)', 'parasitic, other specified and unspecified infections', 'parkinson`s disease', 
             'pericarditis and pericardial disease', 'peripheral and visceral vascular disease', 'peritonitis and intra-abdominal abscess', 
             'pleurisy, pleural effusion and pulmonary collapse', 'pneumonia (except that caused by tuberculosis)', 'pneumothorax', 
             'postprocedural or postoperative circulatory system complication', 'postprocedural or postoperative complications of the spleen', 
             'postprocedural or postoperative digestive system complication', 'postprocedural or postoperative endocrine or metabolic complication',
             'postprocedural or postoperative nervous system complication', 'postprocedural or postoperative respiratory system complication', 
             'postthrombotic syndrome and venous insufficiency/hypertension', 'pressure ulcer of skin', 'pulmonary heart disease', 
             'regional enteritis and ulcerative colitis', 'respiratory cancers', 'respiratory failure; insufficiency; arrest', 'retinal and vitreous conditions',
             'sarcoma', 'schizophrenia spectrum and other psychotic disorders', 'secondary malignancies', 'sedative-related disorders', 'septicemia', 
             'sequela of hemorrhagic cerebrovascular disease', 'sequela of specified infectious disease conditions', 
             'sequela of specified nervous system conditions', 'sexually transmitted infections (excluding hiv and hepatitis)', 'sickle cell trait/anemia', 
             'skin and subcutaneous tissue infections', 'skin cancers - all other types', 'skin cancers - basal cell carcinoma', 'skin cancers - melanoma', 
             'skin cancers - squamous cell carcinoma', 'stimulant-related disorders', 'thyroid disorders', 'transient cerebral ischemia', 
             'tuberculosis', 'unacceptable dx1', 'urinary system cancers - all other types', 'urinary system cancers - bladder', 
             'urinary system cancers - kidney', 'urinary system cancers - ureter and renal pelvis', 'urinary system cancers - urethra', 
             'urinary tract infections', 'varicose veins of lower extremity', 'viral infection'
            ],
        'labs': ['abnormal - (non-numeric)', 'above high normal', 'above highest instrument scale',
                 'above upper panic limits',
                 'below low normal', 'below lower panic limits', 'below lowest instrument scale', 'better',
                 'intermediate',
                 'moderately susceptible', 'resistant', 'significant change down',
                 'significant change up',
                 'susceptible', 'very abnormal - (non-numeric)', 'very susceptible', 'worse'],
        'days_since_last_admission': 16,  # MAP the record only if days_since_last_admission < 16
        'days_since_last_transfer': 31,   # MAP the record only if days_since_last_transfer < 31
        'med_duration': 30,  # MAP the records only if the med occurred in last 30 days
        'alert_duration': 14,
        'diet_order_duration': 30,
        'diagnostic_order_duration': 30,
        'lab_order_duration': 30,
        'stat_order_duration': 30,
        'lab_duration': 90,
        'assessments_duration': 7,
        'risks_duration': 30,
        'days_of_leave':30
    },

}

VITAL_FIELD_MAP = {
    'BP - Systolic': 'systolic',
    'diastolicvalue': 'diastolic',
    'Blood Sugar': 'Blood Sugar',
    'O2 sats': 'O2 Saturation',
    'Pain Level': 'Pain',
    'Pulse': 'Pulse',
    'Respiration': 'Respiration',
    'Temperature': 'Temperature',
    'Weight': 'Weight',
}

FEATURE_GROUP_MAPPING = {
    r'cumsum_all_med_gpi_': 'cumsum_med_',
    r'cumsum_\d+_day_med_gpi_': 'cumsum_med_',
    r'cumidx_\d+_day_med_gpi_': 'cumidx_med_',
    r'cumidx_all_med_gpi_': 'cumidx_med_',
    r'cumsum_all_med_gpisub_': 'cumsum_med_',
    r'cumsum_\d+_day_med_gpisub_': 'cumsum_med_',
    r'cumidx_\d+_day_med_gpisub_': 'cumidx_med_',
    r'cumidx_all_med_gpisub_': 'cumidx_med_',
    r'cumsum_all_order_': 'cumsum_order_',
    r'cumidx_all_order_': 'cumidx_order_',
    r'cumsum_\d+_day_order_': 'cumsum_order_',
    r'cumidx_\d+_day_order_': 'cumidx_order_',
    r'cumsum_all_alert_': 'cumsum_alert_',
    r'cumidx_all_alert_': 'cumidx_alert_',
    r'cumsum_\d+_day_alert_': 'cumsum_alert_',
    r'cumidx_\d+_day_alert_': 'cumidx_alert_',
    r'cumsum_all_dx_': 'cumsum_dx_',
    r'cumsum_\d+_day_dx_': 'cumsum_dx_',
    r'cumidx_all_dx_': 'cumidx_dx_',
    r'cumidx_\d+_day_dx_': 'cumidx_dx_',
    r'cumsum_all_labs_': 'cumsum_labs_',
    r'cumidx_all_labs_': 'cumidx_labs_',
    r'cumsum_\d+_day_labs_': 'cumsum_labs_',
    r'cumidx_\d+_day_labs_': 'cumidx_labs_',
    r'cumidx_\d+_day_notes_': 'cumidx_notes_',
    
}

FEATURE_TYPE_MAPPING = {
    r'^med_.*':'Medication',
    r'^cumidx_\d+_day_med_.*': 'Medication',
    r'^cumidx_all_med_.*': 'Medication',
    r'^cumsum_all_med_.*': 'Medication',
    r'^cumsum_\d+_day_med_.*': 'Medication',
    r'^na_indictator_med_.*': 'Medication',
    r'^cumidx_\d+_day_order_other_.*': 'Other Order',
    r'^cumidx_\d+_day_order_supplements_.*': 'Supplement Order',
    r'^cumsum.*diagnostic_orders': 'Diagnostic Order',
    r'^cumsum_\d+_day_diagnostic_count': 'Diagnostic Order',
    r'^na_indictator_order_.*diagnostic_orders': 'Diagnostic Order',
    r'^order_diagnostic_.*': 'Diagnostic Order',
    r'^order_diettype_.*': 'Diet Order',
    r'^order_supplements_.*': 'Diet Order',
    r'^order_fluidconsistency_.*': 'Diet Order',
    r'^order_other_.*': 'Other Order',
    r'^order_diettexture_.*': 'Diet Order',
    r'^na_indictator_order_.*': 'Diet Order',
    r'^cumidx_\d+_day_order_diettexture_.*': 'Diet Order',
    r'^cumidx_\d+_day_order_diettype_.*': 'Diet Order',
    r'^cumidx_\d+_day_order_fluidconsistency_.*': 'Diet Order',
    r'^cumsum_all_alert_.*': 'Alert',
    r'^cumsum_\d+_day_alert_.*': 'Alert',
    r'^cumsum_\d+_day_alerts_.*': 'Alert',
    r'^cumsum_all_alerts_.*': 'Alert',
    r'^cumidx_\d+_day_alerts_.*': 'Alert',
    r'^cumidx_all_alerts_.*': 'Alert',
    r'^cumidx_all_alert_.*': 'Alert',
    r'^cumidx_\d+_day_alert_.*': 'Alert',
    r'^na_indictator_alert_.*': 'Alert',
    r'^na_indictator_alerts_.*': 'Alert',
    r'^alert_.*': 'Alert',
    r'^alerts_.*': 'Alert',
    r'^cumsum_all_dx_.*': 'Diagnosis',
    r'^dx_.*': 'Diagnosis',
    r'^cumsum_\d+_day_dx_.*': 'Diagnosis',
    r'^cumidx_\d+_day_dx_.*': 'Diagnosis',
    r'^cumidx_all_dx_.*': 'Diagnosis',
    r'^na_indictator_dx_.*': 'Diagnosis',
    r'^cumsum_all_labs_.*': 'Lab',
    r'^cumidx_all_labs_.*': 'Lab',
    r'^cumsum_\d+_day_labs_.*': 'Lab',
    r'^cumidx_\d+_day_labs_.*': 'Lab',
    r'^na_indictator_labs_.*': 'Lab',
    r'^labs_.*': 'Lab',
    r'^vtl_.*': 'Vital',
    r'^na_indictator_vtl_.*': 'Vital',
    r'^demo_.*': 'Demographic',
    r'^na_indictator_religion$': 'Demographic',
    r'^na_indictator_education$': 'Demographic',
    r'^na_indictator_race$': 'Demographic',
    r'^na_indictator_citizenship$': 'Demographic',
    r'^na_indictator_state$': 'Demographic',
    r'^dateofbirth_.*': 'Demographic',
    r'^notes.*': 'Progress Note',
    r'^cumsum_\d+_day_notes_.*': 'Progress Note',
    r'^cumsum_all_notes_.*': 'Progress Note',
    r'^cumidx_all_notes_.*': 'Progress Note',
    r'^cumidx_\d+_day_notes_.*': 'Progress Note',
    r'^hosp_count.*': 'patient_rehosps',
    r'^hosp_days.*': 'patient_rehosps',
    r'^na_indictator_hosp_.*': 'patient_rehosps',
    r'^censusdate_.*': 'patient_census',
    r'^na_indictator_roomratetypedescription$': 'patient_census',
    r'^na_indictator_carelevelcode$': 'patient_census',
    r'^na_indictator_beddescription$': 'patient_census',
    r'^admissions.*': 'Admissions',
    r'^risk_.*': 'Risk',
    r'^assessments_.*': 'Assessments',
    r'^immun_.*': 'Immunizations',
    r'^order_laboratory_.*': 'Lab Order',
    r'^cumidx_\d+_day_order_laboratory_.*': 'Lab Order',
    r'^cumidx_.*laboratory_orders': 'Lab Order',
    r'^cumsum_\d+_day_order_laboratory_.*': 'Lab Order',
    r'^cumsum_.*laboratory_orders': 'Lab Order',
    r'^na_indictator_order_.*laboratory_orders': 'Lab Order',
    r'^cumidx_\d+_day_order_stat_.*': 'Stat Order',
    r'^order_stat_.*': 'Stat Order',
    r'^cumidx_.*stat_orders': 'Stat Order',
    r'^cumsum_\d+_day_order_stat_.*': 'Stat Order',
    r'^cumsum_.*stat_orders': 'Stat Order',
    r'^na_indictator_order_.*stat_orders': 'Stat Order',
}


TZ = timezone('US/Eastern')
